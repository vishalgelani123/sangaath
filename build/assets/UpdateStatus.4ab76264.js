import{A as q,N as L,_ as V,U,o as A,f as B}from"./AppLayout.c471b81a.js";import{L as N,a0 as j,B as d,o as r,c as P,w as c,a as e,e as l,b as n,f as m,F,i as M,g as H,t as u}from"./app.c9482037.js";import{_ as R}from"./TextInput.86ba2c92.js";import{_ as z}from"./InputLabel.5855d489.js";import{_ as E}from"./_plugin-vue_export-helper.cdc0426e.js";import{r as G,a as K,b as Y}from"./MagnifyingGlassIcon.72cf383a.js";import{r as Q,a as X,b as J,c as O}from"./XCircleIcon.b480e10e.js";import{r as W}from"./CloudArrowDownIcon.82ddc2f3.js";import{r as Z}from"./CheckCircleIcon.00a0f7b3.js";const $={components:{AppLayout:q,TextInput:R,InputLabel:z,Dialog:L,DialogPanel:V,DialogTitle:U,TransitionChild:A,TransitionRoot:B,Link:N,MagnifyingGlassIcon:G,PlusIcon:K,ExclamationTriangleIcon:Y,EyeIcon:Q,CloudArrowDownIcon:W,CloudArrowUpIcon:X,CheckIcon:J,CheckCircleIcon:Z,XCircleIcon:O},props:["initial_forms"],data(){return{searched_forms:[],loaded_forms:this.initial_forms,display_forms:this.initial_forms,last_search_query:"",search_query:"",is_search_complete:!1,is_loading:!1,has_reached_search_bottom:!1,has_reached_bottom:!1,search_loaded_rows:0,loaded_rows:50,update_status_form:{show_popup:!1,popup_title:"",form_id:"",date:{value:"",error:!1},processing:!1},documents:{},delete_form:{site_name:"",form_id:null,show_popup:!1,processing:!1}}},mounted(){window.addEventListener("scroll",function(){const a=window.innerHeight+window.scrollY,i=document.body.scrollHeight-a,_=200;!(this.search_query.length>0?this.has_reached_search_bottom:this.has_reached_bottom)&&!this.is_loading&&i<_&&(this.is_loading=!0,this.loadMoreData())}.bind(this))},methods:{debouncedSearch:j.exports.debounce(function(){this.search()},500),search(){var a=this.search_query.toString().toLowerCase().trim();a.length>0&&a!=this.last_search_query&&(this.has_reached_search_bottom=!1,this.loadMoreData(!0))},loadMoreData(a=!1){a&&(this.search_loaded_rows=0,this.searched_forms=[],this.has_reached_search_bottom=!1);let s=null,i=this.loaded_rows;this.search_query.length>0&&(s=`&search=${this.search_query}`,this.last_search_query=this.search_query.toString().toLowerCase(),i=this.search_loaded_rows),axios.get(`/update-status?is_ajax=1&skip=${i}${s!=null?s:""}`).then(function(_){const t=_.data;t.rows&&(s?(this.searched_forms.push(...t.rows),this.search_loaded_rows=this.searched_forms.length):(this.loaded_forms.push(...t.rows),this.loaded_rows=this.loaded_forms.length),this.is_loading=!1,this.is_search_complete=!0,t.rows.length==0&&(s?this.has_reached_search_bottom=!0:this.has_reached_bottom=!0))}.bind(this))},updateStatus(a,s){this.update_status_form.form_id=s,this.update_status_form.popup_title=a,this.update_status_form.date.error=!1,this.update_status_form.show_popup=!0},validateForm(){this.update_status_form.date.error=!1;var a=this.update_status_form.date.value;if(a.length==0){this.update_status_form.date.error=!0;return}this.updateStatusProcess(a)},updateStatusProcess(a){this.update_status_form.processing=!0;var s=new FormData;s.append("form_id",this.update_status_form.form_id),s.append("date",a);var i=this;axios.post("/update-status/save",s).then(function(_){i.delete_form.processing=!1;var t=_.data;t.status==1&&i.$inertia.visit("/update-status",{only:["all_forms"]})})}}},ee={class:"flex-1"},te=e("div",{class:"border-b border-gray-200 px-4 py-5 flex items-center justify-between sm:px-6 lg:px-8"},[e("div",{class:"min-w-0 flex-1"},[e("h1",{class:"text-lg font-medium leading-6 text-gray-900 sm:truncate"},"Update Status")]),e("div",{class:"flex mt-0 ml-4"})],-1),se={key:0,class:"mt-6 px-4 sm:px-6 lg:px-8"},oe={class:"max-w-sm"},ae={class:"relative rounded-md shadow-sm"},re={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},ie={class:"mt-6"},le={key:0,class:"mt-20 inline-block min-w-full align-middle"},ne=e("div",{class:"flex items-center flex-col"},[e("img",{src:"/images/document-complete.png",class:"w-72",alt:""}),e("h3",{class:"mt-2 text-lg font-semibold text-gray-900"},"No forms available"),e("p",{class:"mt-1 text-sm text-gray-500"},"You have no forms available to update.")],-1),de=[ne],ce={key:1,class:"inline-block min-w-full border-b border-gray-200 align-middle"},_e=e("a",{href:"",id:"download_document_link",class:"hidden",download:""},null,-1),ue={class:"min-w-full"},pe=e("thead",null,[e("tr",{class:"border-t border-gray-200"},[e("th",{class:"border-b border-gray-200 bg-gray-50 px-6 py-3 text-left text-sm font-semibold text-gray-900",scope:"col"},[e("span",{class:"lg:pl-2"},"Name")]),e("th",{class:"border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900",scope:"col"},"Village"),e("th",{class:"hidden border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900 md:table-cell",scope:"col"},"Applied for"),e("th",{class:"hidden border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900 md:table-cell",scope:"col"},"Applied on"),e("th",{class:"hidden border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900 md:table-cell",scope:"col"},"Documentation on"),e("th",{class:"border-b border-gray-200 bg-gray-50 py-3 pr-6 text-right text-sm font-semibold text-gray-900",scope:"col"})])],-1),me={class:"divide-y divide-gray-100 bg-white"},he={class:"whitespace-nowrap px-6 py-3 text-sm font-medium text-gray-900"},fe={class:"flex items-center space-x-3 lg:pl-2"},ge={class:"hidden whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 md:table-cell"},ye={class:"hidden whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 md:table-cell"},xe={class:"hidden whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 md:table-cell"},be={class:"hidden whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 md:table-cell"},ve={class:"whitespace-nowrap px-6 py-3 text-right text-sm font-medium"},we=["onClick"],ke={key:0},Ce=e("td",{colspan:"5",class:"whitespace-nowrap px-6 py-3 text-sm font-medium text-gray-900"},[e("span",{class:"lg:pl-2 text-gray-600 font-medium"},"No results found!")],-1),De=[Ce],Ie=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),Se={class:"fixed inset-0 z-10 overflow-y-auto"},Te={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},qe={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pt-5 sm:pb-4"},Le={class:"flex justify-between items-center"},Ve=e("div",{class:"mt-1"},[e("p",{class:"text-sm text-gray-500"},"Select date to update status of the form")],-1),Ue={class:"my-5 flex flex-col gap-y-6"},Ae={class:""},Be={class:"relative rounded-md shadow-sm"},Ne={key:0,class:"mt-1 text-red-600 text-sm"},je={class:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6"},Pe=e("span",null,"Update",-1),Fe=[Pe],Me={key:1,class:"group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold bg-blue-600 opacity-60 text-white cursor-not-allowed"},He=e("span",null,"Updating",-1),Re=e("svg",{class:"animate-spin ml-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),ze=[He,Re],Ee=e("span",null,"Cancel",-1),Ge=[Ee];function Ke(a,s,i,_,t,p){const w=d("MagnifyingGlassIcon"),h=d("TextInput"),f=d("TransitionChild"),k=d("DialogTitle"),C=d("InputLabel"),D=d("DialogPanel"),I=d("Dialog"),S=d("TransitionRoot"),T=d("AppLayout");return r(),P(T,null,{default:c(()=>[e("div",ee,[te,i.initial_forms.length>0?(r(),l("div",se,[e("div",oe,[e("div",ae,[e("div",re,[n(w,{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),n(h,{modelValue:t.search_query,"onUpdate:modelValue":s[0]||(s[0]=o=>t.search_query=o),onKeyup:p.debouncedSearch,onChange:p.debouncedSearch,autocomplete:"off",id:"search",type:"text",placeholder:"Search Forms",class:"block w-full pl-10 font-medium",required:""},null,8,["modelValue","onKeyup","onChange"])])])])):m("",!0),e("div",ie,[i.initial_forms.length==0?(r(),l("div",le,de)):(r(),l("div",ce,[_e,e("table",ue,[pe,e("tbody",me,[(r(!0),l(F,null,M(t.search_query.length>0&&t.is_search_complete?t.searched_forms:t.loaded_forms,o=>{var g,y,x,b;return r(),l("tr",{key:o.id},[e("td",he,[e("div",fe,u((g=o.beneficiary)==null?void 0:g.name),1)]),e("td",ge,u((x=(y=o.beneficiary)==null?void 0:y.village)==null?void 0:x.name),1),e("td",ye,u((b=o.scheme)==null?void 0:b.name),1),e("td",xe,u(o.applied_date),1),e("td",be,u(o.documentation_date),1),e("td",ve,[e("a",{onClick:Ye=>{var v;return p.updateStatus((v=o.beneficiary)==null?void 0:v.name,o.id)},href:"javascript:void(0)",class:"text-blue-600 hover:text-blue-900"},"Update Status",8,we)])])}),128)),t.display_forms.length==0?(r(),l("tr",ke,De)):m("",!0)])])]))]),n(S,{as:"template",show:t.update_status_form.show_popup},{default:c(()=>[n(I,{as:"div",class:"relative z-10",onClose:s[4]||(s[4]=o=>t.update_status_form.show_popup=!1)},{default:c(()=>[n(f,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:c(()=>[Ie]),_:1}),e("div",Se,[e("div",Te,[n(f,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:c(()=>[n(D,{class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-xs"},{default:c(()=>[e("div",qe,[e("div",Le,[e("div",null,[n(k,{as:"h3",class:"text-lg font-medium leading-6 text-gray-900"},{default:c(()=>[H(u(t.update_status_form.popup_title),1)]),_:1}),Ve])]),e("div",Ue,[e("div",Ae,[n(C,{for:"update_status_date",value:"Date"}),e("div",Be,[n(h,{modelValue:t.update_status_form.date.value,"onUpdate:modelValue":s[1]||(s[1]=o=>t.update_status_form.date.value=o),id:"update_status_date",type:"date",class:"block w-full font-medium",required:""},null,8,["modelValue"])]),t.update_status_form.date.error?(r(),l("p",Ne,"Please select valid date")):m("",!0)])])]),e("div",je,[t.update_status_form.processing?t.update_status_form.processing?(r(),l("button",Me,ze)):m("",!0):(r(),l("button",{key:0,onClick:s[2]||(s[2]=(...o)=>p.validateForm&&p.validateForm(...o)),type:"button",class:"group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold focus:outline-none focus-visible:outline-2 focus-visible:outline-offset-2 bg-blue-600 text-white hover:text-slate-100 hover:bg-blue-500 active:bg-blue-800 active:text-blue-100 focus-visible:outline-blue-600"},Fe)),t.update_status_form.processing?m("",!0):(r(),l("button",{key:2,onClick:s[3]||(s[3]=o=>t.update_status_form.show_popup=!1),type:"button",class:"mr-3 group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold focus:outline-none focus-visible:outline-2 focus-visible:outline-offset-2 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 active:bg-gray-100 focus-visible:outline-blue-600"},Ge))])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])]),_:1})}const st=E($,[["render",Ke]]);export{st as default};
