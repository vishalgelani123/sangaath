import{A as V,N as j,_ as L,U as R,o as A,f as B}from"./AppLayout.c471b81a.js";import{L as N,a0 as U,B as c,o as r,c as G,w as m,a as e,e as i,b as n,f as p,F as M,i as P,g as H,t as d,D as z,G as E}from"./app.c9482037.js";import{_ as K}from"./TextInput.86ba2c92.js";import{_ as Y}from"./InputLabel.5855d489.js";import{_ as Q}from"./_plugin-vue_export-helper.cdc0426e.js";import{r as X,a as J,b as O}from"./MagnifyingGlassIcon.72cf383a.js";import{r as W,a as Z,b as $,c as ee}from"./XCircleIcon.b480e10e.js";import{r as te}from"./CloudArrowDownIcon.82ddc2f3.js";import{r as se}from"./CheckCircleIcon.00a0f7b3.js";const oe={components:{AppLayout:V,TextInput:K,InputLabel:Y,Dialog:j,DialogPanel:L,DialogTitle:R,TransitionChild:A,TransitionRoot:B,Link:N,MagnifyingGlassIcon:X,PlusIcon:J,ExclamationTriangleIcon:O,EyeIcon:W,CloudArrowDownIcon:te,CloudArrowUpIcon:Z,CheckIcon:$,CheckCircleIcon:se,XCircleIcon:ee},props:["initial_forms"],data(){return{searched_forms:[],loaded_forms:this.initial_forms,display_forms:this.initial_forms,last_search_query:"",search_query:"",is_search_complete:!1,is_loading:!1,has_reached_search_bottom:!1,has_reached_bottom:!1,search_loaded_rows:0,loaded_rows:50,selectedForms:[],update_status_form:{show_popup:!1,popup_title:"",form_id:"",type:"",date:{value:"",error:!1},processing:!1},documents:{},delete_form:{site_name:"",form_id:null,show_popup:!1,processing:!1}}},mounted(){window.addEventListener("scroll",function(){const a=window.innerHeight+window.scrollY,l=document.body.scrollHeight-a,_=200;!(this.search_query.length>0?this.has_reached_search_bottom:this.has_reached_bottom)&&!this.is_loading&&l<_&&(this.is_loading=!0,this.loadMoreData())}.bind(this))},methods:{debouncedSearch:U.exports.debounce(function(){this.search()},500),search(){var a=this.search_query.toString().toLowerCase().trim();a.length>0&&a!=this.last_search_query&&(this.has_reached_search_bottom=!1,this.loadMoreData(!0))},loadMoreData(a=!1){a&&(this.search_loaded_rows=0,this.searched_forms=[],this.has_reached_search_bottom=!1);let t=null,l=this.loaded_rows;this.search_query.length>0&&(t=`&search=${this.search_query}`,this.last_search_query=this.search_query.toString().toLowerCase(),l=this.search_loaded_rows),axios.get(`/govt-submission?is_ajax=1&skip=${l}${t!=null?t:""}`).then(function(_){const s=_.data;s.rows&&(t?(this.searched_forms.push(...s.rows),this.search_loaded_rows=this.searched_forms.length):(this.loaded_forms.push(...s.rows),this.loaded_rows=this.loaded_forms.length),this.is_loading=!1,this.is_search_complete=!0,s.rows.length==0&&(t?this.has_reached_search_bottom=!0:this.has_reached_bottom=!0))}.bind(this))},generateReport(){var a=this.selectedForms.join(",");window.location.href="/govt-submission/report/"+a},updateStatus(a){this.update_status_form.form_id=this.selectedForms.join(","),a=="submitted"?this.update_status_form.popup_title="Submitted to Govt.":this.update_status_form.popup_title="Rejected",this.update_status_form.type=a,this.update_status_form.date.error=!1,this.update_status_form.show_popup=!0},validateForm(){this.update_status_form.date.error=!1;var a=this.update_status_form.date.value;if(a.length==0){this.update_status_form.date.error=!0;return}this.updateStatusProcess(a)},updateStatusProcess(a){this.update_status_form.processing=!0;var t=new FormData;t.append("form_ids",this.update_status_form.form_id),t.append("date",a),t.append("update_type",this.update_status_form.type);var l=this;axios.post("/govt-submission/update-status",t).then(function(_){l.delete_form.processing=!1;var s=_.data;s.status==1&&l.$inertia.visit("/govt-submission",{only:["initial_forms"]})})}}},ae={class:"flex-1"},re=e("div",{class:"border-b border-gray-200 px-4 py-5 flex items-center justify-between sm:px-6 lg:px-8"},[e("div",{class:"min-w-0 flex-1"},[e("h1",{class:"text-lg font-medium leading-6 text-gray-900 sm:truncate"},"Submit to Govt.")]),e("div",{class:"flex mt-0 ml-4"})],-1),ie={key:0,class:"mt-6 px-4 sm:px-6 lg:px-8"},le={class:"max-w-sm"},ne={class:"relative rounded-md shadow-sm"},de={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},ce={class:"mt-6"},ue={key:0,class:"mt-20 inline-block min-w-full align-middle"},me=e("div",{class:"flex items-center flex-col"},[e("img",{src:"/images/document-complete.png",class:"w-72",alt:""}),e("h3",{class:"mt-2 text-lg font-semibold text-gray-900"},"No forms available"),e("p",{class:"mt-1 text-sm text-gray-500"},"You have no forms available to update.")],-1),pe=[me],_e={key:1,class:"relative overflow-hidden inline-block min-w-full border-b border-gray-200 align-middle"},he=e("a",{href:"",id:"download_document_link",class:"hidden",download:""},null,-1),fe={key:0,class:"absolute top-[1px] left-12 flex h-12 items-center space-x-3 bg-gray-50 sm:left-16"},ge={class:"min-w-full"},be=e("thead",null,[e("tr",{class:"border-t border-gray-200"},[e("th",{class:"border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900",scope:"col"}),e("th",{class:"border-b border-gray-200 bg-gray-50 px-6 py-3 text-left text-sm font-semibold text-gray-900",scope:"col"},[e("span",{class:"lg:pl-2"},"Name")]),e("th",{class:"border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900",scope:"col"},"Village"),e("th",{class:"hidden border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900 md:table-cell",scope:"col"},"Applied for"),e("th",{class:"hidden border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900 md:table-cell",scope:"col"},"Applied on"),e("th",{class:"hidden border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900 md:table-cell",scope:"col"},"Documentation on"),e("th",{class:"hidden border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900 md:table-cell",scope:"col"},"FS verified on"),e("th",{class:"hidden border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900 md:table-cell",scope:"col"},"Follow Up")])],-1),ye={class:"divide-y divide-gray-100 bg-white"},xe={class:"relative w-12 px-6 sm:w-16 sm:px-8"},ve={key:0,class:"absolute inset-y-0 left-0 w-0.5 bg-blue-600"},we=["value"],ke={class:"whitespace-nowrap px-6 py-3 text-sm font-medium text-gray-900"},Ce={class:"lg:pl-2"},De={class:"font-medium text-gray-900"},Se={class:"text-gray-500 text-xs"},Ie={class:"hidden whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 md:table-cell"},Fe={class:"hidden whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 md:table-cell"},Te={class:"hidden whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 md:table-cell"},qe={class:"hidden whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 md:table-cell"},Ve={class:"hidden whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 md:table-cell"},je={class:"hidden whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 md:table-cell"},Le={key:0},Re=e("td",{colspan:"5",class:"whitespace-nowrap px-6 py-3 text-sm font-medium text-gray-900"},[e("span",{class:"lg:pl-2 text-gray-600 font-medium"},"No results found!")],-1),Ae=[Re],Be=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),Ne={class:"fixed inset-0 z-10 overflow-y-auto"},Ue={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},Ge={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pt-5 sm:pb-4"},Me={class:"flex justify-between items-center"},Pe=e("div",{class:"mt-1"},[e("p",{class:"text-sm text-gray-500"},"Select date to update status of the form")],-1),He={class:"my-5 flex flex-col gap-y-6"},ze={class:""},Ee={class:"relative rounded-md shadow-sm"},Ke={key:0,class:"mt-1 text-red-600 text-sm"},Ye={class:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6"},Qe=e("span",null,"Update",-1),Xe=[Qe],Je={key:1,class:"group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold bg-blue-600 opacity-60 text-white cursor-not-allowed"},Oe=e("span",null,"Updating",-1),We=e("svg",{class:"animate-spin ml-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),Ze=[Oe,We],$e=e("span",null,"Cancel",-1),et=[$e];function tt(a,t,l,_,s,u){const k=c("MagnifyingGlassIcon"),h=c("TextInput"),f=c("TransitionChild"),C=c("DialogTitle"),D=c("InputLabel"),S=c("DialogPanel"),I=c("Dialog"),F=c("TransitionRoot"),T=c("AppLayout");return r(),G(T,null,{default:m(()=>[e("div",ae,[re,l.initial_forms.length>0?(r(),i("div",ie,[e("div",le,[e("div",ne,[e("div",de,[n(k,{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),n(h,{modelValue:s.search_query,"onUpdate:modelValue":t[0]||(t[0]=o=>s.search_query=o),onKeyup:u.debouncedSearch,onChange:u.debouncedSearch,autocomplete:"off",id:"search",type:"text",placeholder:"Search Forms",class:"block w-full pl-10 font-medium",required:""},null,8,["modelValue","onKeyup","onChange"])])])])):p("",!0),e("div",ce,[l.initial_forms.length==0?(r(),i("div",ue,pe)):(r(),i("div",_e,[he,s.selectedForms.length>0?(r(),i("div",fe,[e("button",{onClick:t[1]||(t[1]=(...o)=>u.generateReport&&u.generateReport(...o)),type:"button",class:"inline-flex items-center rounded border border-gray-300 bg-white px-2.5 py-1.5 text-xs font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-30"}," Generate Report "),e("button",{onClick:t[2]||(t[2]=o=>u.updateStatus("submitted")),type:"button",class:"inline-flex items-center rounded border border-green-600 bg-white px-2.5 py-1.5 text-xs font-medium text-green-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-600 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-30"}," Submitted "),e("button",{onClick:t[3]||(t[3]=o=>u.updateStatus("rejected")),type:"button",class:"inline-flex items-center rounded border border-red-600 bg-white px-2.5 py-1.5 text-xs font-medium text-red-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-red-600 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-30"}," Rejected ")])):p("",!0),e("table",ge,[be,e("tbody",ye,[(r(!0),i(M,null,P(s.search_query.length>0&&s.is_search_complete?s.searched_forms:s.loaded_forms,o=>{var g,b,y,x,v,w;return r(),i("tr",{key:o.id},[e("td",xe,[s.selectedForms.includes(o.id)?(r(),i("div",ve)):p("",!0),z(e("input",{type:"checkbox",class:"absolute left-4 top-1/2 -mt-2 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 sm:left-6",value:o.id,"onUpdate:modelValue":t[4]||(t[4]=q=>s.selectedForms=q)},null,8,we),[[E,s.selectedForms]])]),e("td",ke,[e("div",Ce,[e("div",De,d((g=o.beneficiary)==null?void 0:g.name),1),e("div",Se,"#"+d((b=o.beneficiary)==null?void 0:b.member_id)+"-"+d(o.scheme_id),1)])]),e("td",Ie,d((x=(y=o.beneficiary)==null?void 0:y.village)==null?void 0:x.name),1),e("td",Fe,d((v=o.scheme)==null?void 0:v.name),1),e("td",Te,d(o.applied_date),1),e("td",qe,d(o.documentation_date),1),e("td",Ve,d(o.liasoning_date),1),e("td",je,d((w=o.scheme)==null?void 0:w.followup_days)+" days",1)])}),128)),s.display_forms.length==0?(r(),i("tr",Le,Ae)):p("",!0)])])]))]),n(F,{as:"template",show:s.update_status_form.show_popup},{default:m(()=>[n(I,{as:"div",class:"relative z-10",onClose:t[8]||(t[8]=o=>s.update_status_form.show_popup=!1)},{default:m(()=>[n(f,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:m(()=>[Be]),_:1}),e("div",Ne,[e("div",Ue,[n(f,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:m(()=>[n(S,{class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-xs"},{default:m(()=>[e("div",Ge,[e("div",Me,[e("div",null,[n(C,{as:"h3",class:"text-lg font-medium leading-6 text-gray-900"},{default:m(()=>[H(d(s.update_status_form.popup_title),1)]),_:1}),Pe])]),e("div",He,[e("div",ze,[n(D,{for:"update_status_date",value:"Date"}),e("div",Ee,[n(h,{modelValue:s.update_status_form.date.value,"onUpdate:modelValue":t[5]||(t[5]=o=>s.update_status_form.date.value=o),id:"update_status_date",type:"date",class:"block w-full font-medium",required:""},null,8,["modelValue"])]),s.update_status_form.date.error?(r(),i("p",Ke,"Please select valid date")):p("",!0)])])]),e("div",Ye,[s.update_status_form.processing?s.update_status_form.processing?(r(),i("button",Je,Ze)):p("",!0):(r(),i("button",{key:0,onClick:t[6]||(t[6]=(...o)=>u.validateForm&&u.validateForm(...o)),type:"button",class:"group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold focus:outline-none focus-visible:outline-2 focus-visible:outline-offset-2 bg-blue-600 text-white hover:text-slate-100 hover:bg-blue-500 active:bg-blue-800 active:text-blue-100 focus-visible:outline-blue-600"},Xe)),s.update_status_form.processing?p("",!0):(r(),i("button",{key:2,onClick:t[7]||(t[7]=o=>s.update_status_form.show_popup=!1),type:"button",class:"mr-3 group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold focus:outline-none focus-visible:outline-2 focus-visible:outline-offset-2 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 active:bg-gray-100 focus-visible:outline-blue-600"},et))])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])]),_:1})}const ut=Q(oe,[["render",tt]]);export{ut as default};
