import{A as E,N as M,_ as P,U,o as F,f as V}from"./AppLayout.c471b81a.js";import{L as H,a0 as O,B as m,o as a,c as D,w as p,a as e,b as l,g,n as b,e as r,f as u,F as I,i as T,t as h}from"./app.c9482037.js";import{_ as G}from"./TextInput.86ba2c92.js";import{_ as X}from"./InputLabel.5855d489.js";import{_ as J}from"./_plugin-vue_export-helper.cdc0426e.js";import{r as K,a as Y,b as Q}from"./MagnifyingGlassIcon.72cf383a.js";import{r as R,a as W,b as Z,c as $}from"./XCircleIcon.b480e10e.js";import{r as ee}from"./CloudArrowDownIcon.82ddc2f3.js";import{r as te}from"./CheckCircleIcon.00a0f7b3.js";const se={components:{AppLayout:E,TextInput:G,InputLabel:X,Dialog:M,DialogPanel:P,DialogTitle:U,TransitionChild:F,TransitionRoot:V,Link:H,MagnifyingGlassIcon:K,PlusIcon:Y,ExclamationTriangleIcon:Q,EyeIcon:R,CloudArrowDownIcon:ee,CloudArrowUpIcon:W,CheckIcon:Z,CheckCircleIcon:te,XCircleIcon:$},props:["initial_forms"],data(){return{searched_forms:[],loaded_forms:this.initial_forms,display_forms:this.initial_forms,last_search_query:"",search_query:"",is_search_complete:!1,is_loading:!1,has_reached_search_bottom:!1,has_reached_bottom:!1,search_loaded_rows:0,loaded_rows:50,application_form:{show_popup:!1,applied_popup_show:!1,popup_title:"",form_id:"",member_row_id:"",scheme_id:"",selecting_pre_requisite_id:null,documents:null,eligible_status:"",incomplete_processing:!1,mark_complete_processing:!1},documents:{},delete_form:{site_name:"",form_id:null,show_popup:!1,processing:!1}}},mounted(){window.addEventListener("scroll",function(){const s=window.innerHeight+window.scrollY,n=document.body.scrollHeight-s,c=200;!(this.search_query.length>0?this.has_reached_search_bottom:this.has_reached_bottom)&&!this.is_loading&&n<c&&(this.is_loading=!0,this.loadMoreData())}.bind(this))},methods:{debouncedSearch:O.exports.debounce(function(){this.search()},500),search(){var s=this.search_query.toString().toLowerCase().trim();s.length>0&&s!=this.last_search_query&&(this.has_reached_search_bottom=!1,this.loadMoreData(!0))},loadMoreData(s=!1){s&&(this.search_loaded_rows=0,this.searched_forms=[],this.has_reached_search_bottom=!1);let t=null,n=this.loaded_rows;this.search_query.length>0&&(t=`&search=${this.search_query}`,this.last_search_query=this.search_query.toString().toLowerCase(),n=this.search_loaded_rows),axios.get(`/documentation/complete?is_ajax=1&skip=${n}${t!=null?t:""}`).then(function(c){const o=c.data;o.rows&&(t?(this.searched_forms.push(...o.rows),this.search_loaded_rows=this.searched_forms.length):(this.loaded_forms.push(...o.rows),this.loaded_rows=this.loaded_forms.length),this.is_loading=!1,this.is_search_complete=!0,o.rows.length==0&&(t?this.has_reached_search_bottom=!0:this.has_reached_bottom=!0))}.bind(this))},startApplication(s){this.application_form.popup_title=s.beneficiary.name,this.application_form.scheme_id=s.scheme_id,this.application_form.form_id=s.id,this.application_form.member_row_id=s.beneficiary.id,this.application_form.show_popup=!0,this.application_form.eligible_status="eligible";var t=this;axios.get("/household/scheme/"+s.scheme_id+"/"+s.beneficiary.id).then(function(n){var c=n.data.data;if(c!=null){var o=c.documents;t.application_form.documents={};for(var d in o){var _=o[d];_.is_selected||(_.is_selected=!1,_.preview_url=""),_.file="",t.application_form.documents[_.prerequisite_id]=_}}})},selectDocument(s,t="application_form"){var n=this[t].documents[s].is_selected;n?this.viewDocument(s,t):(this[t].selecting_pre_requisite_id=s,document.getElementById("document_selector").click())},viewDocument(s,t="application_form"){var n=this[t].documents[s].preview_url;window.open(n,"_blank")},removeDocument(s,t="application_form"){var n=this[t].documents[s];n.is_selected=!1,n.preview_url="",n.file=""},previewImage(s,t="application_form"){if(s.target.files[0]!=null){var n=URL.createObjectURL(s.target.files[0]),c=(s.target.files[0].size/1024/1024).toFixed(4);if(c>10)alert("Image too large! Please select an image smaller than 10 MB");else{var o=this[t].selecting_pre_requisite_id;this[t].documents[o].is_selected=!0,this[t].documents[o].preview_url=n,this[t].documents[o].file=s.target.files[0]}document.getElementById("document_selector").value=""}},saveSchemeIncomplete(){var s=new FormData,t=this.application_form.documents,n=[];for(var c in t){var o=this.application_form.documents[c];o.file!=""&&(s.append("document_"+c,o.file),n.push(c))}s.append("selected_documents",JSON.stringify(n)),s.append("scheme_id",this.application_form.scheme_id),s.append("member_row_id",this.application_form.member_row_id),s.append("form_id",this.application_form.form_id),this.application_form.incomplete_processing=!0;var d=this;axios.post("/application/save-incomplete",s).then(function(_){d.$inertia.visit("/documentation/incomplete",{only:["loaded_forms"]})})},markCompleteScheme(){var s=new FormData,t=this.application_form.documents,n=[];for(var c in t){var o=this.application_form.documents[c];o.file!=""&&(s.append("document_"+c,o.file),n.push(c))}s.append("selected_documents",JSON.stringify(n)),s.append("scheme_id",this.application_form.scheme_id),s.append("member_row_id",this.application_form.member_row_id),s.append("form_id",this.application_form.form_id),s.append("eligible_status",this.application_form.eligible_status),this.application_form.incomplete_processing=!0;var d=this;axios.post("/application/skip-apply",s).then(function(_){d.$inertia.visit("/documentation/incomplete",{only:["loaded_forms"]})})},deleteForm(s){this.delete_form.form_id=s,this.delete_form.show_popup=!0},deleteProcess(){this.delete_form.processing=!0;var s=new FormData;s.append("form_id",this.delete_form.form_id);var t=this;axios.post("/documentation/complete/delete",s).then(function(n){t.delete_form.processing=!1;var c=n.data;c.status==1&&t.$inertia.visit("/documentation/complete",{only:["loaded_forms"]})})}}},oe={class:"flex-1"},ie={class:"flex items-center justify-between"},ne={class:"w-full border-b border-gray-200"},ae={class:"-mb-px flex","aria-label":"Tabs"},le={key:0,class:"mt-6 px-4 sm:px-6 lg:px-8"},re={class:"max-w-sm"},ce={class:"relative rounded-md shadow-sm"},de={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},pe={class:"mt-6"},me={key:0,class:"mt-20 inline-block min-w-full align-middle"},_e=e("div",{class:"flex items-center flex-col"},[e("img",{src:"/images/document-complete.png",class:"w-72",alt:""}),e("h3",{class:"mt-2 text-lg font-semibold text-gray-900"},"No Complete documents"),e("p",{class:"mt-1 text-sm text-gray-500"},"You have no completed documents.")],-1),ue=[_e],he={key:1,class:"inline-block min-w-full border-b border-gray-200 align-middle"},fe={class:"min-w-full"},ge=e("thead",null,[e("tr",{class:"border-t border-gray-200"},[e("th",{class:"border-b border-gray-200 bg-gray-50 px-6 py-3 text-left text-sm font-semibold text-gray-900",scope:"col"},[e("span",{class:"lg:pl-2"},"Name")]),e("th",{class:"hidden border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900 md:table-cell",scope:"col"},"Applied for"),e("th",{class:"hidden border-b border-gray-200 bg-gray-50 px-6 py-3 text-right text-sm font-semibold text-gray-900 md:table-cell",scope:"col"},"Documented on"),e("th",{class:"border-b border-gray-200 bg-gray-50 py-3 pr-6 text-right text-sm font-semibold text-gray-900",scope:"col"})])],-1),ye={class:"divide-y divide-gray-100 bg-white"},be={class:"whitespace-nowrap px-6 py-3 text-sm font-medium text-gray-900"},xe={class:"flex items-center space-x-3 lg:pl-2"},ve={class:"hidden whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 md:table-cell"},we={class:"font-medium"},ke={class:"text-gray-500"},Ce={class:"hidden whitespace-nowrap px-6 py-3 text-right text-sm text-gray-500 md:table-cell"},De={class:"whitespace-nowrap px-6 py-3 text-right text-sm font-medium"},Ie=["onClick"],Te={key:0},Se=e("td",{colspan:"5",class:"whitespace-nowrap px-6 py-3 text-sm font-medium text-gray-900"},[e("span",{class:"lg:pl-2 text-gray-600 font-medium"},"No results found!")],-1),je=[Se],Le=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),qe={class:"fixed inset-0 z-10 overflow-y-auto"},Ae={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},Be={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pt-5 sm:pb-4"},Ne={class:"flex justify-between items-center"},ze=e("div",{class:"mt-1"},[e("p",{class:"text-sm text-gray-500"},"Upload the documents below to continue")],-1),Ee={key:0,class:"mt-5"},Me={key:0,class:"grid grid-cols-2 gap-3"},Pe=["onClick"],Ue={class:"col-span-11"},Fe={class:"text-xs font-medium text-gray-700"},Ve={key:1},He={class:"hidden group-hover:flex absolute right-5 bottom-2 gap-3"},Oe={key:1},Ge=e("p",{class:"text-sm text-gray-600 italic"},"No documents needed for this scheme",-1),Xe=[Ge],Je={class:"bg-gray-50 px-4 py-3 flex justify-between sm:px-6"},Ke=e("span",null,"Close",-1),Ye=[Ke],Qe={key:1},Re={class:"flex flex-row-reverse gap-6"},We=e("span",null,"Save as In-Complete",-1),Ze=[We],$e=e("span",null,"Mark as complete",-1),et=[$e],tt={key:2,class:"group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold bg-blue-600 opacity-60 text-white cursor-not-allowed"},st=e("span",null,"Saving",-1),ot=e("svg",{class:"animate-spin ml-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),it=[st,ot],nt=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),at={class:"fixed inset-0 z-10 overflow-y-auto"},lt={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},rt={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},ct={class:"sm:flex sm:items-start"},dt={class:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"},pt={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},mt=e("div",{class:"mt-2"},[e("p",{class:"text-sm text-gray-500"},"Are you sure you want to delete this form? This action cannot be undone.")],-1),_t={class:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6"},ut=e("span",null,"Delete",-1),ht=[ut],ft={key:1,class:"group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold bg-red-600 opacity-60 text-white cursor-not-allowed"},gt=e("span",null,"Deleting",-1),yt=e("svg",{class:"animate-spin ml-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),bt=[gt,yt],xt=e("span",null,"Cancel",-1),vt=[xt];function wt(s,t,n,c,o,d){const _=m("Link"),S=m("MagnifyingGlassIcon"),j=m("TextInput"),y=m("TransitionChild"),x=m("DialogTitle"),L=m("CloudArrowUpIcon"),q=m("CheckCircleIcon"),A=m("EyeIcon"),B=m("XCircleIcon"),v=m("DialogPanel"),w=m("Dialog"),k=m("TransitionRoot"),N=m("ExclamationTriangleIcon"),z=m("AppLayout");return a(),D(z,null,{default:p(()=>[e("div",oe,[e("div",ie,[e("div",ne,[e("nav",ae,[l(_,{href:"/documentation/incomplete",class:b(["border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","w-1/3 py-4 px-1 text-center border-b-2 font-medium text-sm"]),"aria-current":"page"},{default:p(()=>[g("Incomplete")]),_:1}),l(_,{href:"/documentation/pending",class:b(["border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","w-1/3 py-4 px-1 text-center border-b-2 font-medium text-sm"]),"aria-current":"page"},{default:p(()=>[g("Pending")]),_:1}),l(_,{class:b(["border-blue-500 text-blue-600","w-1/3 py-4 px-1 text-center border-b-2 font-semibold text-sm"]),"aria-current":"page"},{default:p(()=>[g("Complete")]),_:1})])])]),n.initial_forms.length>0?(a(),r("div",le,[e("div",re,[e("div",ce,[e("div",de,[l(S,{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),l(j,{modelValue:o.search_query,"onUpdate:modelValue":t[0]||(t[0]=i=>o.search_query=i),onKeyup:d.debouncedSearch,onChange:d.debouncedSearch,autocomplete:"off",id:"search",type:"text",placeholder:"Search Complete Forms",class:"block w-full pl-10 font-medium",required:""},null,8,["modelValue","onKeyup","onChange"])])])])):u("",!0),e("div",pe,[n.initial_forms.length==0?(a(),r("div",me,ue)):(a(),r("div",he,[e("table",fe,[ge,e("tbody",ye,[(a(!0),r(I,null,T(o.search_query.length>0&&o.is_search_complete?o.searched_forms:o.loaded_forms,i=>{var f,C;return a(),r("tr",{key:i.id},[e("td",be,[e("div",xe,h((f=i.beneficiary)==null?void 0:f.name),1)]),e("td",ve,[e("div",we,h((C=i.scheme)==null?void 0:C.name),1),e("div",ke,"On "+h(i.applied_date),1)]),e("td",Ce,h(i.documentation_date),1),e("td",De,[e("a",{onClick:kt=>d.deleteForm(i.id),href:"javascript:void(0)",class:"text-red-600 hover:text-red-900"},"Delete",8,Ie)])])}),128)),o.display_forms.length==0?(a(),r("tr",Te,je)):u("",!0)])])]))]),l(k,{as:"template",show:o.application_form.show_popup},{default:p(()=>[l(w,{as:"div",class:"relative z-10",onClose:t[5]||(t[5]=i=>o.application_form.show_popup=!1)},{default:p(()=>[l(y,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:p(()=>[Le]),_:1}),e("div",qe,[e("div",Ae,[l(y,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:p(()=>[l(v,{class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-3xl"},{default:p(()=>[e("div",Be,[e("div",Ne,[e("div",null,[l(x,{as:"h3",class:"text-lg font-medium leading-6 text-gray-900"},{default:p(()=>[g(h(o.application_form.popup_title),1)]),_:1}),ze])]),o.application_form.documents!=null?(a(),r("div",Ee,[Object.keys(o.application_form.documents).length>0?(a(),r("div",Me,[e("input",{onChange:t[1]||(t[1]=i=>d.previewImage(i)),type:"file",accept:"image/*",id:"document_selector",class:"hidden"},null,32),(a(!0),r(I,null,T(o.application_form.documents,i=>(a(),r("div",{key:i.prerequisite_id,onClick:f=>d.selectDocument(i.prerequisite_id),class:b([{"cursor-pointer":!i.is_selected},"w-full group hover:bg-gray-100 relative border border-gray-200 rounded grid grid-cols-12 items-center px-3 py-2"])},[e("div",Ue,[e("p",Fe,h(i.pre_requisite.name),1)]),i.is_selected?(a(),r("div",Ve,[l(q,{class:"group-hover:hidden text-right text-green-600 h-5 w-5"}),e("div",He,[l(A,{onClick:f=>d.viewDocument(i.prerequisite_id),class:"cursor-pointer text-blue-600 h-5 w-5"},null,8,["onClick"]),l(B,{onClick:f=>d.removeDocument(i.prerequisite_id),class:"cursor-pointer text-red-600 h-5 w-5"},null,8,["onClick"])])])):(a(),D(L,{key:0,class:"text-right text-blue-600 h-5 w-5"}))],10,Pe))),128))])):(a(),r("div",Oe,Xe))])):u("",!0)]),e("div",Je,[!o.application_form.mark_complete_processing&&!o.application_form.incomplete_processing?(a(),r("button",{key:0,onClick:t[2]||(t[2]=i=>o.application_form.show_popup=!1),type:"button",class:"group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold focus:outline-none focus-visible:outline-2 focus-visible:outline-offset-2 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 active:bg-gray-100 focus-visible:outline-blue-600"},Ye)):(a(),r("div",Qe)),e("div",Re,[!o.application_form.mark_complete_processing&&!o.application_form.incomplete_processing?(a(),r("button",{key:0,onClick:t[3]||(t[3]=(...i)=>d.saveSchemeIncomplete&&d.saveSchemeIncomplete(...i)),type:"button",class:"group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold focus:outline-none focus-visible:outline-2 focus-visible:outline-offset-2 bg-blue-600 text-white hover:text-slate-100 hover:bg-blue-500 active:bg-blue-800 active:text-blue-100 focus-visible:outline-blue-600"},Ze)):u("",!0),!o.application_form.mark_complete_processing&&!o.application_form.incomplete_processing?(a(),r("button",{key:1,onClick:t[4]||(t[4]=(...i)=>d.markCompleteScheme&&d.markCompleteScheme(...i)),type:"button",class:"group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold focus:outline-none focus-visible:outline-2 focus-visible:outline-offset-2 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 active:bg-gray-100 focus-visible:outline-blue-600"},et)):u("",!0),o.application_form.mark_complete_processing||o.application_form.incomplete_processing?(a(),r("button",tt,it)):u("",!0)])])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]),l(k,{as:"template",show:o.delete_form.show_popup},{default:p(()=>[l(w,{as:"div",class:"relative z-10",onClose:t[8]||(t[8]=i=>o.delete_form.show_popup=!1)},{default:p(()=>[l(y,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:p(()=>[nt]),_:1}),e("div",at,[e("div",lt,[l(y,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:p(()=>[l(v,{class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-md"},{default:p(()=>[e("div",rt,[e("div",ct,[e("div",dt,[l(N,{class:"h-6 w-6 text-red-600","aria-hidden":"true"})]),e("div",pt,[l(x,{as:"h3",class:"text-lg font-medium leading-6 text-gray-900"},{default:p(()=>[g("Delete?")]),_:1}),mt])])]),e("div",_t,[o.delete_form.processing?o.delete_form.processing?(a(),r("button",ft,bt)):u("",!0):(a(),r("button",{key:0,onClick:t[6]||(t[6]=(...i)=>d.deleteProcess&&d.deleteProcess(...i)),type:"button",class:"group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold focus:outline-none focus-visible:outline-2 focus-visible:outline-offset-2 bg-red-600 text-white hover:text-slate-100 hover:bg-red-500 active:bg-red-800 active:text-red-100 focus-visible:outline-red-600"},ht)),o.delete_form.processing?u("",!0):(a(),r("button",{key:2,onClick:t[7]||(t[7]=i=>o.delete_form.show_popup=!1),type:"button",class:"mr-3 group inline-flex items-center justify-center rounded-full py-1.5 px-6 text-sm font-semibold focus:outline-none focus-visible:outline-2 focus-visible:outline-offset-2 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 active:bg-gray-100 focus-visible:outline-blue-600"},vt))])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])]),_:1})}const Bt=J(se,[["render",wt]]);export{Bt as default};
